# ğŸ”„ n8n Workflow Sync Manager\n\n## ğŸ¯ What This Solves\n\nYour current issue:\n```\nShopware to Qdrant - Final Version\nLast updated 1 hour ago | Created 28 July\nfinal, shopware, qdrant\n```\n\n**Problems:**\nâŒ No version tracking - just \"Final Version\"\nâŒ New workflows created instead of updates\nâŒ No sync between filesystem and n8n\nâŒ No backup before changes\nâŒ No git integration for version control\n\n## âœ… Solution: Automated Workflow Sync\n\n**Automated Features:**\nâœ… **Version Numbers**: `v1.0.0`, `v1.0.1`, `v1.0.2` instead of \"Final Version\"\nâœ… **Bidirectional Sync**: Changes in n8n â†” Filesystem automatically\nâœ… **Git Integration**: Auto-commits with meaningful messages\nâœ… **Backup System**: Automatic backups before any changes\nâœ… **Change Detection**: Only syncs when workflows actually change\nâœ… **Conflict Resolution**: Smart merging of concurrent changes\n\n## ğŸš€ Quick Start\n\n### 1. **Start the Sync Manager**\n```bash\n# For local n8n (no API key needed)\n./start-workflow-sync.sh\n\n# For remote n8n (with API key)\nexport N8N_API_KEY=\"your-n8n-api-key\"\n./start-workflow-sync.sh\n```\n\n### 2. **Monitor via Web Interface**\nOpen: http://localhost:3001/health\n\n### 3. **Check Your Workflows**\nVisit: http://localhost:3001/workflows\n\n## ğŸ”§ How It Works\n\n### **Every 1 Minute (Automatic):**\n1. **Checks n8n** for workflow changes\n2. **Detects changes** using content hashing  \n3. **Updates version numbers** automatically\n4. **Syncs to filesystem** with proper filenames\n5. **Creates backups** before any updates\n6. **Commits to git** with descriptive messages\n\n### **Version Management:**\n```javascript\n// Your workflow will automatically get:\n{\n  \"name\": \"Shopware to Qdrant - AI Enhanced\",\n  \"version\": \"1.0.3\",  // Auto-incremented\n  \"versionHistory\": [\n    {\"version\": \"1.0.0\", \"timestamp\": \"2024-07-28T10:00:00Z\"},\n    {\"version\": \"1.0.1\", \"timestamp\": \"2024-07-28T11:00:00Z\"},\n    {\"version\": \"1.0.2\", \"timestamp\": \"2024-07-28T12:00:00Z\"}\n  ],\n  \"meta\": {\n    \"lastSync\": \"2024-07-28T13:00:00Z\",\n    \"changes\": [\"nodes_added\", \"connections_modified\"]\n  }\n}\n```\n\n## ğŸ“Š Monitoring & Control\n\n### **API Endpoints:**\n```bash\n# Health check\ncurl http://localhost:3001/health\n\n# List all workflows with versions\ncurl http://localhost:3001/workflows\n\n# Manual sync trigger\ncurl -X POST http://localhost:3001/sync\n\n# View version history\ncurl http://localhost:3001/workflows/workflow-id/history\n\n# Create manual backup\ncurl -X POST http://localhost:3001/backup/workflow-id\n```\n\n### **File Structure:**\n```\nn8n-held-shopware/\nâ”œâ”€â”€ workflows/                    # Synced workflow files\nâ”‚   â”œâ”€â”€ shopware_to_qdrant_ai_enhanced.json\nâ”‚   â””â”€â”€ other_workflow.json\nâ”œâ”€â”€ workflow-backups/             # Automatic backups\nâ”‚   â”œâ”€â”€ shopware_to_qdrant_2024-07-28t10-00-00_update.json\nâ”‚   â””â”€â”€ shopware_to_qdrant_2024-07-28t11-00-00_update.json\nâ””â”€â”€ .git/                        # Version control\n```\n\n## ğŸ¯ Expected Results\n\n### **Before (Current State):**\n```\nâŒ \"Shopware to Qdrant - Final Version\"\nâŒ No version tracking\nâŒ Manual workflow management\nâŒ Risk of losing changes\n```\n\n### **After (With Sync Manager):**\n```\nâœ… \"Shopware to Qdrant - AI Enhanced v1.0.3\"\nâœ… Full version history\nâœ… Automatic sync and backups\nâœ… Git-tracked changes\nâœ… Change detection and conflict resolution\n```\n\n## âš™ï¸ Configuration Options\n\n### **Environment Variables:**\n```bash\nexport N8N_URL=\"http://localhost:5678\"        # n8n server\nexport N8N_API_KEY=\"your-api-key\"             # For remote n8n\nexport SYNC_INTERVAL=60000                    # 1 minute sync\nexport WORKFLOWS_DIR=\"./workflows\"            # Local storage\nexport GIT_AUTO_COMMIT=true                   # Auto git commits\n```\n\n### **Advanced Features:**\n- **Change Detection**: Only syncs when content actually changes\n- **Conflict Resolution**: Handles concurrent edits intelligently\n- **Backup Strategy**: Keeps backups before any modifications\n- **Git Integration**: Meaningful commit messages with change summaries\n- **Web Dashboard**: Real-time monitoring and manual control\n\n## ğŸ” Troubleshooting\n\n### **Sync Not Working:**\n```bash\n# Check n8n connection\ncurl http://localhost:5678/api/v1/workflows\n\n# Check sync manager health\ncurl http://localhost:3001/health\n\n# Manual sync test\ncurl -X POST http://localhost:3001/sync\n```\n\n### **Permission Issues:**\n```bash\n# Ensure directories exist\nmkdir -p workflows workflow-backups\n\n# Check file permissions\nls -la workflows/\n```\n\n### **Git Issues:**\n```bash\n# Initialize git if needed\ngit init\ngit config user.name \"n8n Sync\"\ngit config user.email \"sync@n8n.local\"\n```\n\n## ğŸš€ Integration with Your Current Workflow\n\n### **Step 1: Sync Existing Workflow**\nYour current \"Shopware to Qdrant - Final Version\" will automatically:\n1. Be detected by the sync manager\n2. Get assigned version `v1.0.0`\n3. Be saved to `workflows/shopware_to_qdrant_final_version.json`\n4. Be committed to git\n\n### **Step 2: Make Changes in n8n**\nWhen you update the workflow in n8n:\n1. Sync manager detects changes within 1 minute\n2. Creates backup of `v1.0.0`\n3. Updates workflow to `v1.0.1`\n4. Commits changes to git with message: \"Update workflow: Shopware to Qdrant - Final Version (v1.0.1)\"\n\n### **Step 3: Version History**\nView complete history:\n```bash\ncurl http://localhost:3001/workflows/your-workflow-id/history\n```\n\n## ğŸ‰ Benefits\n\n1. **No More \"Final Version\"** - Proper semantic versioning\n2. **Automatic Backups** - Never lose workflow changes\n3. **Git History** - Full version control with meaningful commits\n4. **Change Tracking** - See exactly what changed between versions\n5. **Conflict Resolution** - Handle concurrent edits intelligently\n6. **Monitoring** - Web dashboard for real-time status\n7. **API Control** - Programmatic access for automation\n\nYour workflows will now have proper version management and be automatically synchronized! ğŸ¯