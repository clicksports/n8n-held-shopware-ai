# ü§ñ Autonomous Shopware-Qdrant Sync Service\n\n## üéØ What This Does\n\nRuns **independently** from n8n and automatically maintains your Qdrant collection with properly consolidated product data:\n\n‚úÖ **No more fragmented timestamp points** (`2025-07-18T09:20:32.911+00:00`)\n‚úÖ **No more isolated hash points** (`000fc3e434c14f73a4ef2562c6113d9f`)\n‚úÖ **Single consolidated product points** with complete information\n‚úÖ **Automatic sync every 5 minutes** with full sync every 24 hours\n‚úÖ **REST API for manual control** and monitoring\n‚úÖ **Self-healing with error recovery**\n\n## üöÄ Quick Start\n\n### 1. **Set Your API Key**\n```bash\nexport SHOPWARE_API_KEY=\"your-shopware-api-key-here\"\n```\n\n### 2. **Start the Autonomous Service**\n```bash\n./start-autonomous-sync.sh\n```\n\n### 3. **Monitor via Web Interface**\nOpen: http://localhost:3000/health\n\n## üìä Monitoring & Control\n\n### **Health Check**\n```bash\ncurl http://localhost:3000/health\n```\n\n### **View Statistics**\n```bash\ncurl http://localhost:3000/stats\n```\n\n### **Manual Sync Trigger**\n```bash\ncurl -X POST http://localhost:3000/sync\n```\n\n### **Full Sync Trigger**\n```bash\ncurl -X POST http://localhost:3000/sync/full\n```\n\n### **Clear Collection**\n```bash\ncurl -X DELETE http://localhost:3000/collection\n```\n\n### **Upload Sample Data**\n```bash\ncurl -X POST http://localhost:3000/sample-data\n```\n\n## ‚öôÔ∏è Configuration\n\nCopy `.env.example` to `.env` and customize:\n```bash\ncp .env.example .env\n```\n\nKey settings:\n- **SYNC_INTERVAL**: How often to check for updates (default: 5min)\n- **FULL_SYNC_INTERVAL**: How often to do complete sync (default: 24h)\n- **BATCH_SIZE**: Products processed per batch (default: 10)\n\n## üîÑ What It Does Automatically\n\n### **Every 5 Minutes (Incremental Sync):**\n1. Checks Shopware for updated products\n2. Fetches comprehensive data (variants, reviews, categories)\n3. Creates consolidated Qdrant points\n4. Updates only changed products\n\n### **Every 24 Hours (Full Sync):**\n1. Processes all active products\n2. Ensures data consistency\n3. Handles any missed updates\n\n### **Data Consolidation:**\n- **Product Details**: Name, description, pricing\n- **Variants**: All sizes, colors, individual pricing\n- **Reviews**: Customer ratings with sentiment analysis\n- **Categories**: Product classification\n- **Manufacturer**: Brand information\n- **AI Tags**: Searchable semantic keywords\n\n## üìà Benefits Over n8n Workflow\n\n| Feature | n8n Workflow | Autonomous Service |\n|---------|--------------|-------------------|\n| **Independence** | Requires n8n running | Standalone service |\n| **Monitoring** | n8n interface only | Web API + health checks |\n| **Error Recovery** | Manual restart | Self-healing |\n| **Scheduling** | Basic cron | Intelligent incremental sync |\n| **Resource Usage** | Always running | Efficient background process |\n| **Control** | GUI only | REST API + CLI |\n\n## üõ† Advanced Usage\n\n### **Run as System Service (Linux)**\n```bash\n# Create systemd service\nsudo nano /etc/systemd/system/shopware-sync.service\n```\n\nService file content:\n```ini\n[Unit]\nDescription=Autonomous Shopware-Qdrant Sync Service\nAfter=network.target\n\n[Service]\nType=simple\nUser=your-user\nWorkingDirectory=/path/to/n8n-held-shopware\nEnvironment=SHOPWARE_API_KEY=your-key\nExecStart=/usr/bin/node autonomous-sync-service.js\nRestart=always\nRestartSec=10\n\n[Install]\nWantedBy=multi-user.target\n```\n\nEnable and start:\n```bash\nsudo systemctl enable shopware-sync\nsudo systemctl start shopware-sync\nsudo systemctl status shopware-sync\n```\n\n### **Docker Deployment**\n```dockerfile\nFROM node:18-alpine\nWORKDIR /app\nCOPY package*.json ./\nRUN npm install\nCOPY . .\nEXPOSE 3000\nCMD [\"node\", \"autonomous-sync-service.js\"]\n```\n\n```bash\ndocker build -t shopware-sync .\ndocker run -d -p 3000:3000 -e SHOPWARE_API_KEY=your-key shopware-sync\n```\n\n## üîç Troubleshooting\n\n### **Service Won't Start**\n```bash\n# Check API key\necho $SHOPWARE_API_KEY\n\n# Check Qdrant connection\ncurl http://localhost:6333/collections\n\n# Check logs\nnode autonomous-sync-service.js\n```\n\n### **No Data Syncing**\n```bash\n# Check sync stats\ncurl http://localhost:3000/stats\n\n# Manual sync test\ncurl -X POST http://localhost:3000/sync\n\n# Check Qdrant data\ncurl http://localhost:6333/collections/shopware_products\n```\n\n### **Performance Issues**\n- Reduce `BATCH_SIZE` for lower memory usage\n- Increase `SYNC_INTERVAL` for less frequent checks\n- Monitor via `/stats` endpoint\n\n## üéØ Expected Results\n\n### **Before (Fragmented n8n Output):**\n```\n‚ùå Point 1: \"2025-07-18T09:20:32.911+00:00\"\n‚ùå Point 2: \"000fc3e434c14f73a4ef2562c6113d9f\"  \n‚ùå Point 3: \"EUR\"\n‚ùå Point 4: \"Torver Top Sportjacke\"\n```\n\n### **After (Autonomous Service Output):**\n```\n‚úÖ Point 1: Complete Consolidated Product\n{\n  \"content\": \"Product: Held Touring Jacket | Article: HLD-123 | Brand: Held | Rating: 4.7‚òÖ (156 reviews)\",\n  \"structured_data\": {\n    \"basic_info\": {\"name\": \"Held Touring Jacket\", \"brand\": \"Held\"},\n    \"social_proof\": {\"average_rating\": 4.7, \"total_reviews\": 156},\n    \"variants\": [{\"size\": \"M\", \"price\": 299.95, \"available\": true}]\n  },\n  \"metadata\": {\n    \"ai_searchable_tags\": [\"brand_held\", \"highly_rated\", \"touring\"]\n  }\n}\n```\n\n## üöÄ Start Now\n\n1. **Set API key**: `export SHOPWARE_API_KEY=\"your-key\"`\n2. **Run service**: `./start-autonomous-sync.sh`\n3. **Check status**: `curl http://localhost:3000/health`\n4. **Monitor progress**: Watch console output\n\nYour Qdrant collection will automatically maintain clean, consolidated, AI-ready product data! üéâ